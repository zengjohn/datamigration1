# 前端界面需求文档 (UI/UX Requirements)

**版本**：V1.0

**适用对象**：前端开发工程师 (Vue/React)

### 1. 总体布局与交互规范

- **布局模式**：单页应用 (SPA) 或 左右分栏布局。
- **核心交互**：
  - **自动刷新**：由于后台是异步处理，界面需具备 `Poller`（轮询器），每 3-5 秒自动刷新数据，并提供“暂停/开启刷新”的开关。
  - **级联下钻**：点击“作业” -> 显示“文件明细” -> 点击“查看切片” -> 弹窗显示“切片详情”。
  - **响应式**：适配 PC 端浏览器（最小宽度 1280px）。

### 2. 页面详细需求

#### 2.1 顶部导航栏

- **标题**：显示系统名称（如：数据迁移运维控制台）。
- **功能区**：
  - 【新建迁移作业】按钮（主要操作）。
  - 自动刷新控制（开关及状态提示）。

#### 2.2 区域一：作业列表 (Job List) - 左侧栏

- **展示形式**：列表或卡片流。
- **字段要求**：作业ID、作业名称、监控目录（需做溢出省略处理）、当前状态（Badge显示）。
- **交互逻辑**：
  - **点击行**：高亮选中该行，并触发右侧区域加载对应的“文件明细”。
  - **操作按钮**：
    - 若状态为 `ACTIVE`：显示红色“停止”按钮。
    - 若状态为 `STOPPED`：显示绿色“恢复”按钮。
    - 操作需二次确认 (`confirm`)。

#### 2.3 区域二：文件明细 (Detail List) - 右侧主区域

- **展示形式**：数据表格 (Table)。
- **头部**：显示当前选中的“作业名称”，以及手动“刷新”按钮。
- **字段要求**：ID、源文件名、处理状态、最后更新时间。
- **状态样式 (Color Coding)**：
  - `NEW`: 灰色
  - `TRANSCODING`: 黄色 (动画闪烁可选)
  - `PROCESSING_CHILDS`: 蓝色 (表示正在跑子任务)
  - `FINISHED`: 绿色
  - `FAIL`: 红色
- **操作列**：
  - **查看切片**：点击后弹出模态框 (Modal)。仅当状态非 NEW 时可用。

#### 2.4 弹窗：新建作业 (Create Job Modal)

- **表单字段**：
  1. **作业名称** (Text, 必填)
  2. **源目录路径** (Text, 必填, Placeholder: `/data/incoming/...`)
  3. **目标数据库 URL** (Text, 默认: `jdbc:mysql://...`)
  4. **数据库用户名** (Text)
  5. **数据库密码** (Password)
- **按钮**：取消、立即创建。
- **逻辑**：提交成功后关闭弹窗并刷新左侧列表。

#### 2.5 弹窗：切片监控 (Split Monitor Modal)

- **标题**：显示所属的文件名。
- **内容**：滚动表格，展示该文件拆分出的所有切片。
- **字段要求**：切片ID、切片文件名、当前状态、错误信息（红色高亮）。
- **运维操作**：
  - **重试 (Retry)**：仅当状态为 `FAIL_LOAD` 或 `FAIL_VERIFY` 时显示。
  - 点击“重试”后，前端乐观更新状态为 `WAIT_...`，并Toast提示“指令已下发”。

### 3. 接口对接清单 (API Mapping)

| **页面模块** | **动作**  | **HTTP 方法** | **URL 路径**                        | **备注**                     |
| ------------ | --------- | ------------- | ----------------------------------- | ---------------------------- |
| **作业管理** | 获取列表  | GET           | `/api/migration/jobs`               | 按ID倒序                     |
|              | 创建作业  | POST          | `/api/migration/job/create`         | Body JSON                    |
|              | 停止/恢复 | POST          | `/api/migration/job/{id}/action`    | Query: `?action=stop/resume` |
| **文件明细** | 获取列表  | GET           | `/api/migration/job/{id}/details`   |                              |
| **切片详情** | 获取列表  | GET           | `/api/migration/detail/{id}/splits` |                              |
|              | 人工重试  | POST          | `/api/migration/split/{id}/retry`   |                              |